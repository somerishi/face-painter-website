---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={`${post.data.title} - Blog`} description={post.data.description}>
  <article class="py-20">
    <div class="container mx-auto px-6">
      <div class="max-w-3xl mx-auto">
        <!-- Header -->
        <header class="mb-12">
          <a href="/blog" class="inline-flex items-center text-primary-pink font-semibold hover:underline mb-6">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Back to Blog
          </a>
          
          <time class="block text-sm text-primary-pink font-semibold mb-4">
            {post.data.pubDate.toLocaleDateString('en-US', { 
              year: 'numeric', 
              month: 'long', 
              day: 'numeric' 
            })}
          </time>
          
          <h1 class="font-display text-4xl md:text-5xl mb-4">{post.data.title}</h1>
          
          <p class="text-xl text-gray-600 mb-6">{post.data.description}</p>
          
          {post.data.tags && post.data.tags.length > 0 && (
            <div class="flex flex-wrap gap-2">
              {post.data.tags.map((tag) => (
                <span class="px-3 py-1 text-sm font-semibold bg-primary-purple/20 text-primary-purple rounded-full">
                  {tag}
                </span>
              ))}
            </div>
          )}
        </header>

        <!-- Featured Image -->
        {post.data.image && (
          <div class="mb-12 rounded-2xl overflow-hidden shadow-lg">
            <img 
              src={post.data.image} 
              alt={post.data.title}
              class="w-full"
            />
          </div>
        )}

        <!-- Content -->
        <div class="prose prose-lg max-w-none">
          <Content />
        </div>

        <!-- Share Section -->
        <div class="mt-16 pt-8 border-t border-gray-200">
          <p class="text-gray-600 mb-4">Enjoyed this post? Share it with others!</p>
          <div class="flex gap-4">
            <a 
              href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(post.data.title)}&url=${encodeURIComponent(Astro.site + '/blog/' + post.slug)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
            >
              Share on Twitter
            </a>
            <a 
              href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(Astro.site + '/blog/' + post.slug)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="px-4 py-2 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition-colors"
            >
              Share on Facebook
            </a>
          </div>
        </div>
      </div>
    </div>
  </article>

  <!-- Back to Blog CTA -->
  <section class="py-12 bg-white/50">
    <div class="container mx-auto px-6 text-center">
      <h2 class="font-heading text-2xl mb-4">Want to Read More?</h2>
      <a href="/blog" class="btn-primary">View All Posts</a>
    </div>
  </section>
</BaseLayout>

<style>
  .prose {
    @apply text-gray-700;
  }
  
  .prose h2 {
    @apply font-heading text-2xl mt-8 mb-4 text-dark;
  }
  
  .prose h3 {
    @apply font-heading text-xl mt-6 mb-3 text-dark;
  }
  
  .prose p {
    @apply mb-4 leading-relaxed;
  }
  
  .prose ul, .prose ol {
    @apply mb-4 ml-6;
  }
  
  .prose li {
    @apply mb-2;
  }
  
  .prose a {
    @apply text-primary-pink hover:underline;
  }
  
  .prose strong {
    @apply font-semibold text-dark;
  }
  
  .prose code {
    @apply bg-gray-100 px-2 py-1 rounded text-sm;
  }
</style>
